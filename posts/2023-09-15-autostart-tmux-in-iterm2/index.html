<!doctype html><html><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><title>Autostart Tmux in iTerm2 - POLOXUE's BLOG</title><meta name=viewport content="width=device-width,initial-scale=1"><meta itemprop=name content="Autostart Tmux in iTerm2"><meta itemprop=description content="This post will introduce three solutions about how to autostart Tmux when starting iTerm2."><meta itemprop=datePublished content="2023-09-15T21:22:36+08:00"><meta itemprop=dateModified content="2023-09-15T21:22:36+08:00"><meta itemprop=wordCount content="800"><meta itemprop=keywords content="iTerm2,Tmux,"><meta property="og:title" content="Autostart Tmux in iTerm2"><meta property="og:description" content="This post will introduce three solutions about how to autostart Tmux when starting iTerm2."><meta property="og:type" content="article"><meta property="og:url" content="https://en.poloxue.com/posts/2023-09-15-autostart-tmux-in-iterm2/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2023-09-15T21:22:36+08:00"><meta property="article:modified_time" content="2023-09-15T21:22:36+08:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="Autostart Tmux in iTerm2"><meta name=twitter:description content="This post will introduce three solutions about how to autostart Tmux when starting iTerm2."><script data-goatcounter=https://enpoloxue.goatcounter.com/count async src=//gc.zgo.at/count.js></script>
<link rel=stylesheet type=text/css media=screen href=https://en.poloxue.com/css/normalize.css><link rel=stylesheet type=text/css media=screen href=https://en.poloxue.com/css/main.css><link rel=stylesheet type=text/css media=screen href=https://en.poloxue.com/css/extra.css><link id=dark-scheme rel=stylesheet type=text/css href=https://en.poloxue.com/css/dark.css><script src=https://en.poloxue.com/js/feather.min.js></script>
<script src=https://en.poloxue.com/js/main.js></script></head><body><div class="container-wide wrapper"><div class=header><div class=avatar><a href=https://en.poloxue.com/><img src=/avatar.webp alt="POLOXUE's BLOG"></a></div><h1 class=site-title><a href=https://en.poloxue.com/>POLOXUE's BLOG</a></h1><div class=site-description><nav class="nav social"><ul class=flat><li><a href=https://github.com/poloxue/ title=Github><i data-feather=github></i></a></li><li><a href=/index.xml title=RSS><i data-feather=rss></i></a></li><span class=scheme-toggle><a href=# id=scheme-toggle></a></ul></nav></div><nav class=nav><ul class=flat><li><a href=/>HOME</a></li><li><a href=/posts>POSTS</a></li><li><a href=/tags>TAGS</a></li><li><a href=/about/>ABOUT</a></li></ul></nav></div><div class=article-nav id=article-nav-id><div class=post><div class=post-header><div class=meta><div class=date><span class=day>15</span>
<span class=rest>Sep 2023</span></div></div><div class=matter><h1 class=title>Autostart Tmux in iTerm2</h1></div></div><aside class="show-on-mobile toc" id=static-toc><header><h3>Contents</h3></header><nav id=TableOfContents><ol><li><a href=#solution-1-a-single-line-shell-script>Solution 1: A single-line shell script</a></li><li><a href=#solution-2-python-script>Solution 2: python script</a></li><li><a href=#solution-3-use-tmux-built-in-menu-tree>Solution 3: Use tmux built-in menu tree</a></li></ol></nav></aside><div style=position:relative;padding-bottom:56.25%;height:0;overflow:hidden><iframe src=https://www.youtube.com/embed/UB1ArJ444_Q style=position:absolute;top:0;left:0;width:100%;height:100%;border:0 allowfullscreen title="YouTube Video"></iframe></div><p>This post will introduce how to autostart Tmux when starting iTerm2.</p><p>By default, every time you start iTerm2, you need to enter tmux attach to enter tmux mode.</p><p>I use Tmux to manage workspaces for different projects. Common IDEs generally provide an interface for users to select projects. Naturally, can iTerm2 + Tmux have a similar function?</p><p>Very simple!</p><h2 id=solution-1-a-single-line-shell-script>Solution 1: A single-line shell script</h2><p>First, let&rsquo;s see a bash script:</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>tmux ls <span style=color:#f92672>&amp;&amp;</span> read -p <span style=color:#e6db74>&#34;Select a session&lt;default&gt;:&#34;</span> tmux_session <span style=color:#f92672>&amp;&amp;</span> tmux attach -t <span style=color:#e6db74>${</span>tmux_session<span style=color:#66d9ef>:-</span>default<span style=color:#e6db74>}</span> <span style=color:#f92672>||</span> tmux new -s <span style=color:#e6db74>${</span>tmux_session<span style=color:#66d9ef>:-</span>default<span style=color:#e6db74>}</span>
</span></span></code></pre></td></tr></table></div></div><p>The description of this script is as follows:</p><ul><li><code>tmux ls</code>, output the currently available sessions;</li><li><code>read xxx</code>, read user input and store the name of the session you want to open into variable <code>tmux_session</code>;</li><li><code>tmux attach</code>, try to open the session, if <code>tmux_session</code> is empty, open the default session;</li><li><code>tmux new</code>, if opening fails, try to create a new session;</li></ul><p>Note: Because of the <code>read</code> command option <code>-p</code>, you must use bash to run this script.</p><p><strong>Configure iTerm2 startup loading</strong></p><p>Choose &lsquo;Preference -> Profile -> General -> Command -> Select &ldquo;Login Sell&rdquo;，&ldquo;Send text at start&rdquo;&rsquo; and input the above script.</p><p>Restart your iTerm2, and what you will see is like this:</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">3
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>hello: <span style=color:#ae81ff>1</span> windows <span style=color:#f92672>(</span>created Tue Sep <span style=color:#ae81ff>12</span> 17:13:54 2023<span style=color:#f92672>)</span> <span style=color:#f92672>(</span>group hello<span style=color:#f92672>)</span> <span style=color:#f92672>(</span>attached<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>default: <span style=color:#ae81ff>1</span> windows <span style=color:#f92672>(</span>created Wed Sep <span style=color:#ae81ff>13</span> 19:54:36 2023<span style=color:#f92672>)</span> <span style=color:#f92672>(</span>group default<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>Select a session&lt;default&gt;:
</span></span></code></pre></td></tr></table></div></div><p>Input &ldquo;hello&rdquo; and enter , iTerm2 will enter the &ldquo;hello&rdquo; session.</p><p>It&rsquo;s simple and efficient, and a bit like the IDE that lets us select a project after it&rsquo;s started.</p><p>The session list is not concise enough. You can configure the output formatting of <code>tmux ls</code> by the command <code>tmux -F '\#{session_name}'</code>.</p><p>Output:</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>hello
</span></span><span style=display:flex><span>default
</span></span></code></pre></td></tr></table></div></div><h2 id=solution-2-python-script>Solution 2: python script</h2><p>Can I just enter the session index to select? This single line shell script is not easy to implement. I wrote a Python script as follows:</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">23
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#75715e>#!/usr/bin/env python</span>
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> os
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>output <span style=color:#f92672>=</span> os<span style=color:#f92672>.</span>popen(<span style=color:#e6db74>&#34;tmux ls -F </span><span style=color:#ae81ff>\\</span><span style=color:#e6db74>#</span><span style=color:#e6db74>{session_name}</span><span style=color:#e6db74>&#34;</span>)<span style=color:#f92672>.</span>read()
</span></span><span style=display:flex><span>sessions <span style=color:#f92672>=</span> output<span style=color:#f92672>.</span>strip()<span style=color:#f92672>.</span>split(<span style=color:#e6db74>&#34;</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>&#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>print(<span style=color:#e6db74>&#34;Sessions:&#34;</span>)
</span></span><span style=display:flex><span><span style=color:#66d9ef>for</span> index <span style=color:#f92672>in</span> range(len(sessions)):
</span></span><span style=display:flex><span>    print(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;</span><span style=color:#e6db74>{</span>index<span style=color:#e6db74>}</span><span style=color:#e6db74> - </span><span style=color:#e6db74>{</span>sessions[index]<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>input_value <span style=color:#f92672>=</span> input(<span style=color:#e6db74>&#34;Please select a session &lt;Index or Name&gt;(default):&#34;</span>)
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> input_value<span style=color:#f92672>.</span>isdigit():
</span></span><span style=display:flex><span>    sess_name <span style=color:#f92672>=</span> sessions[int(input_value)]
</span></span><span style=display:flex><span><span style=color:#66d9ef>elif</span> <span style=color:#f92672>not</span> input_value:
</span></span><span style=display:flex><span>    sess_name <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;default&#34;</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>else</span>:
</span></span><span style=display:flex><span>    sess_name <span style=color:#f92672>=</span> input_value
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> sess_name <span style=color:#f92672>not</span> <span style=color:#f92672>in</span> sessions:
</span></span><span style=display:flex><span>    answer <span style=color:#f92672>=</span> input(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;New a session `</span><span style=color:#e6db74>{</span>sess_name<span style=color:#e6db74>}</span><span style=color:#e6db74>`?(Y/N)&#34;</span>)
</span></span><span style=display:flex><span>    answer <span style=color:#f92672>==</span> <span style=color:#e6db74>&#34;Y&#34;</span> <span style=color:#f92672>and</span> os<span style=color:#f92672>.</span>system(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;tmux new -s </span><span style=color:#e6db74>{</span>sess_name<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>)  <span style=color:#75715e># pyright: ignore</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>else</span>:
</span></span><span style=display:flex><span>    os<span style=color:#f92672>.</span>system(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;tmux attach -t </span><span style=color:#e6db74>{</span>sess_name<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>)
</span></span></code></pre></td></tr></table></div></div><p>Suppose this file&rsquo;s name is tmux_selector and put it under the home directory.</p><p>Let&rsquo;s configure this script as iTerm2 startup script. Restart our iTerm2.</p><p>We will see:</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">5
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>❯ ~/tmux_selector
</span></span><span style=display:flex><span>Sessions:
</span></span><span style=display:flex><span><span style=color:#ae81ff>0</span> - hello
</span></span><span style=display:flex><span><span style=color:#ae81ff>1</span> - default
</span></span><span style=display:flex><span>Please <span style=color:#66d9ef>select</span> a session &lt;Index or Name&gt;<span style=color:#f92672>(</span>default<span style=color:#f92672>)</span>:
</span></span></code></pre></td></tr></table></div></div><p>This is just a demo. The input of tmux ls has other formatting variables. If you are interested, you can continue to expand. Code snippet <a href=https://gist.github.com/poloxue/37d3d79b35964ab8d885296b84ab4b5a>github address</a>.</p><p>It&rsquo;s good, but wouldn’t it be better if it uses the built-in menu?</p><p>Let&rsquo;s continue!</p><h2 id=solution-3-use-tmux-built-in-menu-tree>Solution 3: Use tmux built-in menu tree</h2><p>After entering tmux mode, you can use the shortcut key <code>prefix-key + s</code> to start the tmux selection menu by default. One strength is the built-in menu can be moved by keys <code>jk</code>.</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-zsh data-lang=zsh><span style=display:flex><span>hello: <span style=color:#ae81ff>1</span> windows <span style=color:#f92672>(</span>created Tue Sep <span style=color:#ae81ff>12</span> 17:13:54 2023<span style=color:#f92672>)</span> <span style=color:#f92672>(</span>group hello<span style=color:#f92672>)</span> <span style=color:#f92672>(</span>attached<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>default: <span style=color:#ae81ff>1</span> windows <span style=color:#f92672>(</span>created Wed Sep <span style=color:#ae81ff>13</span> 19:54:36 2023<span style=color:#f92672>)</span> <span style=color:#f92672>(</span>group default<span style=color:#f92672>)</span>
</span></span></code></pre></td></tr></table></div></div><p>Is there a way to start this menu directly when iTerm2 starts? What a great idea! Actually it&rsquo;s not difficult to implement.</p><p>First, use <code>tmux list-keys</code> to check which command the <code>prefix-key + s</code> is bound.</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">4
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-zsh data-lang=zsh><span style=display:flex><span>$ tmux list-keys
</span></span><span style=display:flex><span>...
</span></span><span style=display:flex><span>bind-key    -T prefix       s                    choose-tree -Zs
</span></span><span style=display:flex><span>...
</span></span></code></pre></td></tr></table></div></div><p>We can display the menu by <code>choose-tree -Zs</code>. In tmux mode, use <code>tmux choose-tree -Zs</code> to test whether it works.</p><p>How to configure it as the iTerm2 startup command?</p><p>This command must be run in tmux mode. How to do? We can use the format <code>tmux attach\; &lt;commands running on tmux mode></code> to achieve this goal.</p><p>The command is as follows:</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-zsh data-lang=zsh><span style=display:flex><span>$ tmux attach<span style=color:#ae81ff>\;</span> choose-tree -zS
</span></span></code></pre></td></tr></table></div></div><p>Try testing this code in non-tmux mode to see if you can successfully show the menu.</p><p>Finally, in order to prevent when the first entry without a session, I further optimized the script. It will create a default session window when no session exists.</p><p>The final script:</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ tmux attach<span style=color:#ae81ff>\;</span> choose-tree -Zs <span style=color:#f92672>||</span> read -p <span style=color:#e6db74>&#34;Create a default session?(Y/N)&#34;</span> anwser <span style=color:#f92672>&amp;&amp;</span> <span style=color:#f92672>[[</span> <span style=color:#e6db74>&#34;</span><span style=color:#e6db74>${</span>anwser<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span> <span style=color:#f92672>==</span> <span style=color:#e6db74>&#34;Y&#34;</span> <span style=color:#f92672>]]</span> <span style=color:#f92672>&amp;&amp;</span> tmux new -t default
</span></span></code></pre></td></tr></table></div></div><p>But there is another disadvantage here. Pressing <code>q</code> can only exit the menu and the terminal is still in the tmux mode. One more step of detach is required to exit. This is a difference from the steps we generally think of.</p></div><nav class="hide-on-mobile section-nav"><nav id=TableOfContents><ol><li><a href=#solution-1-a-single-line-shell-script>Solution 1: A single-line shell script</a></li><li><a href=#solution-2-python-script>Solution 2: python script</a></li><li><a href=#solution-3-use-tmux-built-in-menu-tree>Solution 3: Use tmux built-in menu tree</a></li></ol></nav></nav></div><div class=post><hr class=footer-separator><div class=tags><ul class=flat><li class=tag-li><a href=/tags/iterm2>iTerm2</a></li><li class=tag-li><a href=/tags/tmux>Tmux</a></li></ul></div><div class=back><a href=https://en.poloxue.com/><span aria-hidden=true>← Back</span></a></div><div class=back></div></div></div><div class="footer wrapper"><nav class=nav><div>2023 Polo Xue All rights reserved</div></nav></div><script>feather.replace()</script><script>var enableTruncate=!0,filterDepth=!1;const MAX_DEPTH=9;window.addEventListener("DOMContentLoaded",()=>{const e=new IntersectionObserver(e=>{e.reverse().forEach(e=>{const n=e.target.getAttribute("id");if(e.intersectionRatio>0){var t=document.querySelectorAll(`nav li a[href="#${n}"]`);t!=null&&t.forEach(e=>{if(e!=null){var t=getDepth(e.parentElement);filterDepth&&t<=MAX_DEPTH&&(clearActiveStatesInTableOfContents(),e.parentElement.classList.add("active"))}else filterDepth||(clearActiveStatesInTableOfContents(),e.parentElement.classList.add("active"))})}})});document.querySelectorAll("h1[id],h2[id],h3[id],h4[id]").forEach(t=>{e.observe(t)})});function isVisible(e){if(!(e instanceof Element))return!1;const n=getComputedStyle(e);if(n.display==="none")return!1;if(n.visibility!=="visible")return!1;if(n.opacity<.1)return!1;if(e.offsetWidth+e.offsetHeight+e.getBoundingClientRect().height+e.getBoundingClientRect().width===0)return!1;const t={x:e.getBoundingClientRect().left+e.offsetWidth/2,y:e.getBoundingClientRect().top+e.offsetHeight/2};if(t.x<0)return!1;if(t.x>(document.documentElement.clientWidth||window.innerWidth))return!1;if(t.y<0)return!1;if(t.y>(document.documentElement.clientHeight||window.innerHeight))return!1;let s=document.elementFromPoint(t.x,t.y);do if(s===e)return!0;while(s=s.parentNode)return!1}function clearActiveStatesInTableOfContents(){document.querySelectorAll("nav li").forEach(e=>{e.classList.remove("active")})}function getDepth(e){for(var t=0;e!==null&&e.tagName.toLowerCase()!=="ul";)t++,e=e.parentElement;return t}function navItems(){var e=document.querySelectorAll("nav nav li a");return Array.from(e).filter(e=>e.href!=null&&e.hash.startsWith("#"))}function lasItemInNavBarVisible(){var e=navItems().slice(-1)[0];return isVisible(e)}document.addEventListener("DOMContentLoaded",function(){if(!enableTruncate)return;var e=navItems();console.log(e),lasItemInNavBarVisible()||(filterDepth=!0,e.forEach(function(e){var t=getDepth(e.parentElement);t>MAX_DEPTH&&e.parentElement.classList.add("depth-nested")}))})</script></body></html>